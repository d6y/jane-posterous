title: SQL Server 2005 : ROW_NUMBER()
date: 2008/12/22 10:22:00 -0800
tags: [{"name":"SQLServer","id":58677928}]
author: Jane Dallaway
alias: /sql-server-2005-rownumber

I got to make use of the SQL Server 2005 function <a href="http://msdn.microsoft.com/en-us/library/ms186734.aspx">ROW_NUMBER</a> for the first time the other day.<p />I have a table named Country which is defined as:<br /><span class="code">CREATE TABLE [dbo].[Country]<br />(<br /> [Id] [int] NOT NULL,<br /> [CountryName] [nvarchar](255) NOT NULL,<br /> [ContinentId] [int] NOT NULL,<br /> [AreaInSquareKm] [int] NOT NULL,<br /> [AlphaCode2] [char](2) NULL,<br /> [AlphaCode3] [char](3) NULL,<br /> CONSTRAINT [PK_Country] PRIMARY KEY CLUSTERED <br />(<br /> [Id] ASC<br />)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]<br />) ON [PRIMARY]</span><p />I wanted to get an incrementing row number for each country where the AreaInSquareKM is larger than 100000, ordered by AreaInSquareKM descending.  To do this, I simply did:<p /><span class="code">SELECT Id, CountryName, AreaInSquareKM, ROW_NUMBER() OVER (Order By AreaInSquareKM DESC)<br />FROM Country<br />WHERE AreaInSquareKM &gt; 100000</span><p />Far simpler than having to put the data into a cursor, or temporary table using an identity column.<div class="blogger-post-footer"><img class="posterous_download_image" src="https://blogger.googleusercontent.com/tracker/14400377-8776365371043393221?l=jane.dallaway.com%2Fblog%2Fblog.html" height="1" alt="" width="1" /></div>
