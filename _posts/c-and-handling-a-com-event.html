title: C# and handling a COM event
date: 2005/07/25 03:27:00 -0700
tags: [{"name":"Development","id":3773169}]
author: Jane Dallaway
alias: /c-and-handling-a-com-event

Another new thing to work out - how to handle events raised by COM DLLs.  <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconhandlingeventsraisedbycomsource.asp">This page</a> at <a href="http://msdn.microsoft.com/default.aspx">msdn</a> contained the start of the answer (or at least the code samples), but it took quite a bit of experimentation to make it work with my COM DLL (written in Delphi - not sure if that confuses matters at all).<p />To make it work I had to:<br />a) create a class level version of the COM component i.e.  EventTest1.clsMainClass evt = new EventTest1.clsMainClass();<br />[Note: example is a VB test event that I've created just to check the logic]<br />b) set up the event handlers, I found that if I started off with typing the object name, i.e. evt, then on typing . the intellisense would offer me the events as well, and if I selected one of those and type += then the rest of the information was available through intellisense (got to live intellisense)<br />i.e. <br />evt.OnComplete += new EventTest1.__clsMain_OnCompleteEventHandler(OnComplete);<br />evt.OnStart += new EventTest1.__clsMain_OnStartEventHandler(OnStart);<p />c) create the event handler<br />i.e. <br />void OnStart(ref string text)<br />{<br /> MessageBox.Show (text);<br />}<p />void OnComplete(ref string text)<br />{<br /> MessageBox.Show (text);<br />}<p />And that is it, simple really...<div class="blogger-post-footer"><img class="posterous_download_image" src="https://blogger.googleusercontent.com/tracker/14400377-112228401767240830?l=jane.dallaway.com%2Fblog%2Fblog.html" height="1" alt="" width="1" /></div>
