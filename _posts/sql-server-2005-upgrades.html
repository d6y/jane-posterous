title: SQL Server 2005 Upgrades
date: 2006/09/13 10:22:00 -0700
tags: [{"name":"SQLServer","id":58646734}]
author: Jane Dallaway
alias: /sql-server-2005-upgrades

I've been running our usual deployment scripts against a SQL 2005 database to see what the damage was.  Not too bad as it turns out, 2 procedures which used alias.columnname in the ORDER BY clause, 2 logons where the password wasn't secure enough, and 2 DTS packages which aren't deployed due to :<br /><span class="code">SQL Server blocked access to procedure 'sys.sp_OACreate' of component 'Ole Automation Procedures' because this component is turned off as part of the security configuration for this server. A system administrator can enable the use of 'Ole Automation Procedures' by using sp_configure. For more information about enabling 'Ole Automation Procedures', see "Surface Area Configuration" in SQL Server Books Online.</span><p />I want to use <a href="http://msdn2.microsoft.com/en-us/library/ms188787.aspx">sp_configure</a> to achieve this, as our product is deployed mainly automatically, including the database scripts.  Most of the help I could find revolved around the <a href="http://msdn2.microsoft.com/en-us/library/ms173748.aspx">SQL Server Surface Area Configuration</a> and using either the SQL Server 2005 Surface Area Configuration tool or even the command line <a href="http://msdn2.microsoft.com/en-us/library/ms162800.aspx">sac Utility</a>.  I decided to initially take a look at the tool to get an idea, and on investigation, the option I need falls under <a href="http://msdn2.microsoft.com/en-us/library/ms183753.aspx">Surface Area Configuration for Features</a> and is listed under <a href="http://msdn2.microsoft.com/en-us/library/ms188945.aspx">OLE Automation</a>.  After a bit more digging, I found that the <a href="http://msdn2.microsoft.com/en-us/library/ms191188.aspx">sp_configure option</a> is Ole Automation Procedures and so the code is: <br /><span class="code">EXEC sp_configure 'Ole Automation Procedures';<br />GO</span> <br />but this results in the following:<br /><span class="code">Msg 15123, Level 16, State 1, Procedure sp_configure, Line 51<br />The configuration option 'Ole Automation Procedures' does not exist, or it may be an advanced option.</span><br />and so needs to be paired with the Show Advanced Options setting, and so the following is required:<br /><span class="code">sp_configure 'show advanced options', 1;<br />GO<br />RECONFIGURE;<br />GO<br />sp_configure 'Ole Automation Procedures', 1;<br />GO<br />RECONFIGURE;<br />GO</span><br />This results in the following:<br /><span class="code">Configuration option 'show advanced options' changed from 0 to 1. Run the RECONFIGURE statement to install.<br />Configuration option 'Ole Automation Procedures' changed from 0 to 1. Run the RECONFIGURE statement to install.</span><br />and when I re-run the deployment scripts I get no errors.  Hurrah!<div class="blogger-post-footer"><img class="posterous_download_image" src="https://blogger.googleusercontent.com/tracker/14400377-115816496082813198?l=jane.dallaway.com%2Fblog%2Fblog.html" height="1" alt="" width="1" /></div>
