title: Do identity columns get reset after a rollback transaction?
date: 2009/02/04 02:53:00 -0800
tags: [{"name":"SQLServer","id":58677915}]
author: Jane Dallaway
alias: /do-identity-columns-get-reset-after-a-rollbac

A colleague asked me this morning if when you rolled back a transaction the identity values got reset to where they were before you started.  I wasn't sure, I suspected not, but figured I'd try it and find out...<p />I have a simple table called test, which has 2 columns<br /><span class="code">[Id] [int] IDENTITY(1,1) NOT NULL<br />[Word] [nvarchar](50) NULL</span><br />into which I inserted 4 different values as follows, 2 outside of a (rolled back) transaction and 2 within it<p /><span class="code">INSERT INTO [test] ([word])<br />VALUES     ('Insert before transaction')<p />BEGIN TRAN<p />INSERT INTO [test] ([word])<br />VALUES     ('1st insert inside transaction')<p />INSERT INTO [test] ([word])<br />VALUES     ('2nd insert inside transaction')<p />ROLLBACK<p />INSERT INTO [test] ([word])<br />VALUES     ('Insert outside of transaction')</span><p />When I then get the data back out, I have the following items<br /><span class="code">Id&nbsp;&nbsp;&nbsp;Word<br />1&nbsp;&nbsp;&nbsp;Insert before transaction<br />4&nbsp;&nbsp;&nbsp;Insert outside of transaction</span><p />which shows that although the data gets rolled back, the identity value doesn't get reset back to what it was before the transaction.  This can always be done by hand using <span class="code"><a href="http://technet.microsoft.com/en-us/library/ms176057.aspx">DBCC CHECKIDENT</a></span> if necessary.<div class="blogger-post-footer"><img class="posterous_download_image" src="https://blogger.googleusercontent.com/tracker/14400377-7825027971938025452?l=jane.dallaway.com%2Fblog%2Fblog.html" height="1" alt="" width="1" /></div>
