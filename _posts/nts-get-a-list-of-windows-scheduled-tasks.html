title: NTS: Get a list of windows scheduled tasks
date: 2008/06/05 10:07:00 -0700
tags: [{"name":"dos","id":3772701},{"name":"nts","id":3772702}]
author: Jane Dallaway
alias: /nts-get-a-list-of-windows-scheduled-tasks

I've been working on support for a while, and one of my tasks involved checking the set up of a windows scheduled task.  I wanted to script out the scheduled tasks, so I could review them in an easier manner than having to use the GUI and navigating through them all.<p />The dos command <a href="http://technet2.microsoft.com/windowsserver/en/library/1d284efa-9d11-46c2-a8ef-87b297c68d171033.mspx?mfr=true">schtasks</a>  holds the key.  So, after opening a command prompt, the command<p /><span class="code">&nbsp;&nbsp;schtasks /query</span><p />produces a list of all the scheduled tasks, including Task Name, Next Run Time and Status.<br />I wanted a bit more detail, specifically the path of what was scheduled, so I used the command<p /><span class="code">&nbsp;&nbsp;schtasks /query /v /fo LIST</span><p />which produces a detailed list of all tasks.  This includes additional information such as the task being run, schedule information etc<br />Finally, to get the output in a CSV format I used<p /> <span class="code">&nbsp;&nbsp;schtasks /query /v /fo CSV</span><p />This produces the same quantity of detailed information as LIST.<p />So, finally, by piping the output<p /><span class="code">&nbsp;&nbsp;schtasks /query /v /fo CSV > tasks.csv</span><p />I get a tasks.csv file which I can open in Excel and review for correctness and completeness.<div class="blogger-post-footer"><img class="posterous_download_image" src="https://blogger.googleusercontent.com/tracker/14400377-7969446549242431582?l=jane.dallaway.com%2Fblog%2Fblog.html" height="1" alt="" width="1" /></div>
