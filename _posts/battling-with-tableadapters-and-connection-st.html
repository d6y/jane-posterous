title: Battling with TableAdapters and Connection Strings
date: 2006/07/13 06:59:00 -0700
tags: []
author: Jane Dallaway
alias: /battling-with-tableadapters-and-connection-st

I've been looking at a way, other than changing the App.Config settings, of ensuring that all my tableadapters have the correct connection string.  The assembly I am writing will be deployed as a COM dll through a VB application, and so changing the App.Config settings isn't really an option.<p />I found this useful sounding advice <br /><span class="code">Modifying the Accessibility of the TableAdapter and its Connection<br />The default accessibility of TableAdapters is public. You can restrict access to your TableAdapters from outside components by changing the Modifier property for the TableAdapter in the Dataset Designer.<p />Similarly, you can share the connection that a TableAdapter uses by changing the ConnectionModifier property of the TableAdapter in the Dataset Designer. By default, the connection modifier is set to Friend. It is a good practice to leave this modifier set to the default to prevent unknown objects from using your connection (and possibly your credentials) to access the database.</span> on <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnvs05/html/tableadapters.asp">MSDN : TableAdapters in Visual Studio 2005</a>.<p />So, I've created a new Helper class to set up the connections for all of these objects.<br /><span class="code"><br />public class AdapterManager<br />{<br />        private static SqlConnection GetConnection()<br />        {<br />            AppSettings MyApp = AppSettings.GetInstance();<p />            SqlConnection myConnection = new SqlConnection(MyApp.ConnectionString);<br />            return myConnection;<br />        }       <p />        public static void SetPersonConnectionString(PersonTableAdapter ta)<br />        {<p />            ta.Connection = GetConnection();<p />                }<br />}<br /></span><br />then from within the _Load event of my form, I call <br /><span class="code"><br />AdapterManager.SetPersonConnectionString(this.PersonTableAdapter);<br /></span><br />and this seems to work like a charm.  I'm sure there are better ways of doing this.  If you know of one, then please let me know.<div class="blogger-post-footer"><img class="posterous_download_image" src="https://blogger.googleusercontent.com/tracker/14400377-115279568637115839?l=jane.dallaway.com%2Fblog%2Fblog.html" height="1" alt="" width="1" /></div>
