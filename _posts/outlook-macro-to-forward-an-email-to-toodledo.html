title: Outlook macro to forward an email to Toodledo and then file it
date: 2009/10/13 05:23:00 -0700
tags: [{"name":"code","id":3772474},{"name":"nts","id":3772475},{"name":"productivity","id":58674510}]
author: Jane Dallaway
alias: /outlook-macro-to-forward-an-email-to-toodledo

<p>I've recently been having problems with a sore left wrist (not my mouse hand, my Ctrl+C,Ctrl+V hand) and have been assessing what some of my recurrent activities are.  <p /><a href="http://www.madgex.com/">Madgex</a> have bought an <a href="http://www.microsoft.com/hardware/mouseandkeyboard/productdetails.aspx?pid=043">ergonmic keyboard</a> for me to use, and have had the lovely people from <a href="http://www.posturepeople.co.uk/">Posture People</a> in to assess my workstation/posture (my monitors were too far away, my mouse wasn't in the right place, my seat wasn't supporting me properly and I wasn't sitting correctly (think of a seated <a href="http://yoga.iloveindia.com/yoga-poses/tadshana.html">tadasana</a>)).  My new keyboard comes with the concept of Favourites, i.e. quick launch buttons to start frequently used applications. This is a good idea, and got me thinking about other recurrent activities that I could program either a button, or a macro to do.<p />One of my regular activities, as <a href="http://jane.dallaway.com/more-on-time-management">I've mentioned before</a>, is forwarding emails to toodledo for adding to my task list for tomorrow. I do this by sending the email to a unique address, and editing the subject line to include:<br /><span class="code">@@work</span> - i.e. give the task the context of @work<br /><span class="code">#tomorrow</span> - i.e. give the task a due date of tomorrow<br /><span class="code">*Actioned</span> - i.e. put the task in the folder named Actioned<br />I then move the email to a subfolder of my Inbox named Actions<p />I figured that I could write a macro to do this, so with a bit of help from <a href="http://www.pcreview.co.uk/forums/thread-2798274.php">here</a> and <a href="http://verychewy.com/archive/2006/04/12/outlook-macro-to-move-an-email-to-folder.aspx">there</a>, I got the following macro working.  I've named the project "SendTo", so the macro is called as "SendTo.Toodledo" and I've added a shortcut to my menu bar to this macro.  It works on a single email at a time, which suits my process - I try and read the email before deciding whether it needs to be actioned or just filing straight away.<p /><span class="code">Sub Toodledo()<br />'Forward the selected email to Toodledo, updating the subject with the appropriate shortcuts and move to appropriate folder<br />On Error Resume Next<p />&nbsp;&nbsp;Dim objMail As Outlook.MailItem<br />&nbsp;&nbsp;Dim objItem As Outlook.MailItem<p />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set objItem = GetCurrentItem()<br />&nbsp;&nbsp;Set objMail = objItem.Forward<p />&nbsp;&nbsp;&nbsp;&nbsp;objMail.To = "&lt;toodledo email address goes here&gt;" 'my toodledo email address<br />&nbsp;&nbsp;objMail.Subject = "Respond to " + objMail.Subject + " @@work #tomorrow *Actioned" 'Prefix with Respond to, and append context of @work, date of tomorrow, and folder of Actioned<br />&nbsp;&nbsp;objMail.Send<p />&nbsp;&nbsp;&nbsp;&nbsp;Call MoveMessageToFolder(objItem, "Actions")  'move it to my Actions folder<p />&nbsp;&nbsp;&nbsp;&nbsp;'clean up<br />&nbsp;&nbsp;Set objMail = Nothing<br />&nbsp;&nbsp;Set objItem = Nothing<p />End Sub<p />Private Function GetCurrentItem() As Outlook.MailItem<br />'Taken from code sample provided at <a href="http://www.pcreview.co.uk/forums/thread-2798274.php">http://www.pcreview.co.uk/forums/thread-2798274.php</a><br />On Error Resume Next<p />&nbsp;&nbsp;&nbsp;&nbsp;Dim objApp As Outlook.Application<br />&nbsp;&nbsp;Set objApp = Application<p />&nbsp;&nbsp;&nbsp;&nbsp;On Error Resume Next<p />&nbsp;&nbsp;&nbsp;&nbsp;Select Case TypeName(objApp.ActiveWindow)<br />&nbsp;&nbsp;&nbsp;&nbsp;Case "Explorer"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set GetCurrentItem = objApp.ActiveExplorer.Selection.Item(1)<br />&nbsp;&nbsp;&nbsp;&nbsp;Case "Inspector"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set GetCurrentItem = objApp.ActiveInspector.CurrentItem<br />&nbsp;&nbsp;&nbsp;&nbsp;Case Else<br />&nbsp;&nbsp;End Select<p />&nbsp;&nbsp;&nbsp;&nbsp;'clean up<br />&nbsp;&nbsp;Set objApp = Nothing<br />End Function<p />Private Sub MoveMessageToFolder(objItem As Outlook.MailItem, ByVal sFolder As String)<br />'Loosely based on code found at <a href="http://verychewy.com/archive/2006/04/12/outlook-macro-to-move-an-email-to-folder.aspx">http://verychewy.com/archive/2006/04/12/outlook-macro-to-move-an-email-to-fol...</a><br />On Error Resume Next<p /> &nbsp;&nbsp;Dim objFolder As Outlook.MAPIFolder<br />&nbsp;&nbsp;Dim objInbox As Outlook.MAPIFolder<br />&nbsp;&nbsp;Dim objNS As Outlook.NameSpace<p /> &nbsp;&nbsp;Set objNS = Application.GetNamespace("MAPI")<br />&nbsp;&nbsp;Set objInbox = objNS.GetDefaultFolder(olFolderInbox)<br />&nbsp;&nbsp;Set objFolder = objInbox.Folders(sFolder)<p /> &nbsp;&nbsp;If objFolder Is Nothing Then<br />&nbsp;&nbsp;&nbsp;&nbsp;MsgBox "This folder doesn't exist!", vbOKOnly + vbExclamation, "INVALID FOLDER"<br />&nbsp;&nbsp;End If<p />&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;objItem.Move objFolder<p />&nbsp;&nbsp;  &nbsp;&nbsp;'Clean up<br />&nbsp;&nbsp;Set objFolder = Nothing<br />&nbsp;&nbsp;Set objInbox = Nothing<br />&nbsp;&nbsp;Set objNS = Nothing<br />End Sub</span><p />There isn't anything very clever going on here, but having written it, it may just help someone else.<p />Note: I then had to <a href="http://www.howto-outlook.com/howto/selfcert.htm">sign my macro</a> to ensure that this started successfully without warnings on subsequent starts of outlook</p>
