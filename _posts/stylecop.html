title: StyleCop
date: 2008/05/30 06:35:00 -0700
tags: [{"name":".NET","id":58674720}]
author: Jane Dallaway
alias: /stylecop

<p>Earlier in the week, thanks to <a href="http://blog.cwa.me.uk/2008/05/27/the-morning-brew-101/">The Morning Brew #101</a> I downloaded and installed <a href="http://blogs.msdn.com/sourceanalysis/archive/2008/05/23/announcing-the-release-of-microsoft-source-analysis.aspx">Microsoft Source Analysis for C#</a> (aka StyleCop).<p />As a fan of <a href="http://jane.dallaway.com/tag/staticcodeanalysis">FxCop</a> I was interested to find out what this had to offer and so ran it on some new code that Bruce and I have been working on for a <a href="http://jane.dallaway.com/tag/ilp">Madgex ILP</a> project<p /><strong>Running StyleCop</strong><p />I ran it against one (already FxCop'd) file, and came up with the following deviations from the rules (displayed in a new "Source analysis" window):<br /><span class="code">SA1101: The call to m_source must begin with the 'this.' prefix to indicate that the item is a member of the class.<br />SA1200: All using directives must be placed inside of the namespace<br />SA1308: Variable names must not start with 'm_'<br />SA1502: The constructor must not be place on a single line.  The opening and closing curly brackets must each be placed on their own line.<br />SA1600: The class must have a documentation header.<br />SA1600: The constructor must have a documentation header.<br />SA1600: The field must have a documentation header.<br />SA1600: The property must have a documentation header.<br />SA1633: The file has no header, the header Xml is invalid, or the header is not located at the top of the file.</span><p />SA1101 and SA1308 go hand in hand to my mind.  We use m_ to indicate that the item is a class level field, and is the underlying element for a property.  Using "this." instead also shows that this is what is happening.  So, I don't have a problem with this at all.<p />SA1200 is a weird one, this differs from the templates and almost all sample code I've seen on MSDN etc.  There have been quite a few blog posts about this.<p />SA1502 is only ususally done within our code when inheriting the constructor from the base class or this class, i.e. either<br /><span class="code">public NewClass(string name)<br />&nbsp;&nbsp;: base(name) {}</span><br />or<br /><span class="code">public NewClass(string name, string description)<br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;this.myName = name;<br />&nbsp;&nbsp;&nbsp;&nbsp;this.myDescription = description;<br />&nbsp;&nbsp;}<br />public NewClass(string name)<br />&nbsp;&nbsp;: this(name, null) {}</span><p />Changing <span class="code">{}</span> to be <br /><span class="code">{<br />}</span> makes little difference and may improve readability.<p />All the variations of SA1600 are fine - documentation is useful, and using the summary sections is as good a way as any.  I did get some subsequent warnings when I only used a one word description<br /><span class="code">SA1630: The documentation text within the summary tag does not contain any white space between words, indicating that it most likely does not follow a proper grammatical structure required for documentation text.</span><br />or a very short description<br /><span class="code">SA1632: The documentation text within the summary tag must be at least 10 characters in length.  Documentation failing to meet this guidelines most likely does not follow a proper grammatical structure required for documentation text.</span><p />SA1633 is tricky, there is some <a>documentation</a> explaining the rules that a file header must adhere to, which indicates that the minimum file header must be:<br /><span class="code">//&lt;copyright file="Widget.cs" company="Sprocket Enterprises"&gt;<br />//     Copyright (c) Sprocket Enterprises. All rights reserved.<br />// &lt;/copyright&gt;</span><br />This is probably the rule I dislike the most.  I don't have a problem with file headers, but I don't think that the style of those headers should be enforced. Also, not all code actually is done via a Company - it could be personal code, in which case author would be more appropriate.  <p /><strong>Changing the settings</strong><p /><div class='p_embed p_image_embed'>
<img alt="Media_httpfarm4static_qdtlg" height="461" src="/media/getfile/files.posterous.com/import-wdma/ngsihcCxFHlyJfEHoyzAvCzgGChrCfrkJwBtAGjpJfqDdlHCkgBpxjtefzty/media_httpfarm4static_qDtlG.jpg.scaled500.jpg" width="500" />
</div>
<p />There is a settings editor which is included in the Program Files folder, which can be started from the command line as:<br /><span class="code">C:\Program Files\Microsoft Source Analysis Tool for C#&gt;SourceAnalysisSettingsEditor Settings.SourceAnalysis</span><br />where Settings.SourceAnalysis is the predefined file created/installed as part of the installation process.<p />This editor allows settings to be altered/changed to provide additional or more appropriate checks.  Rules can be switched off - so I can prevent SA1633 from being reported to me.  Company information and copyright text can be added so that the Header checking verifies against known and predefined information.<p />The settings editor can also be accessed from with the Visual Studio IDE by right-clicking on the project and selecting the menu option "Source Analysis Settings".  This then created project level settings which is useful when wanting to change the settings on a project by project basis.  To my mind, I'd rather set it on a machine level, and use the same settings across all of my projects - my use of a tool like this would be to ensure consistent styling, and changing the settings on a per project level stops this.  There is an element of merging that can be acheived, by selecting the "Settings File" tab in the editor but how this works in practice I haven't, as yet, had chance to investigate.<p /><a href="http://gabriel.lozano-moran.name/blog/PermaLink,guid,4cbb28ee-f7d1-4895-b95c-7fe291538f46.aspx">The .Net Afficionado</a> has some useful links to find out more information and <a href="http://lovethedot.blogspot.com/">Love The Dot</a> has an article about <a href="http://lovethedot.blogspot.com/2008/05/creating-custom-rules-for-microsoft.html">creating custom rules</a>.</p>
