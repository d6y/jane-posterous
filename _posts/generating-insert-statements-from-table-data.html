title: Generating insert statements from table data - Updated
date: 2008/08/20 11:36:00 -0700
tags: [{"name":"download","id":58674272},{"name":"SQLServer","id":3772642}]
author: Jane Dallaway
alias: /generating-insert-statements-from-table-data

<p>Yesterday Christian left me a comment containing an enhancement for the spu_generateinsert SQL.  His suggestion was adding a new parameter @GenerateOneLinePerColumn to allow more "pretty" SQL to be produced - producing all the columns on separate lines which makes it easier for file comparisons to spot differences when comparing data values.  I thought it made sense, so this morning I used an hour of my <a href="http://jane.dallaway.com/tag/ilp">Madgex ILP</a> time to make this change.<br />By calling <span class="code">EXEC spu_GenerateInsert @table = 'Detail',@GenerateOneLinePerColumn = 0</span> it produces<br /><span class="code">-- ** Start of Inserts<br /> INSERT INTO [Detail] ([ID], [Age]) VALUES (1,36)<br />INSERT INTO [Detail] ([ID], [Age]) VALUES (2,40)<br />-- ** End of Inserts</span><p /> but by calling <span class="code">EXEC spu_GenerateInsert @table = 'Detail',@GenerateOneLinePerColumn = 1</span> it produces<br /><span class="code"><br />-- ** Start of Inserts<br />INSERT INTO [Detail]<br />(<br />[ID],<br />[Age]<br />)<br />VALUES<br />(<br />1,<br />36<br />)<p /> INSERT INTO [Detail]<br />(<br />[ID],<br />[Age]<br />)<br />VALUES<br />(<br />2,<br />40<br />)<br />-- ** End of Inserts</span><p /> Thanks to Christian for this suggestion.  The updated script can be found <a href="http://docs.google.com/Doc?docid=0AfAkC4ZdTI9tZGNwc3d4amNfNmZ4enFubmNz&amp;hl=en_GB">here</a> and related blog posts can be found <a href="http://jane.dallaway.com/tag/spu_generateinsert">here</a>.  <br />Note: this is now only working on SQL 2005 as during my testing I found that VARCHAR(8000) just wasn't long enough so I've made it VARCHAR(max).  This is the only SQL 2005 specific piece of SQL in this procedure and I've put comments in the code to indicate <span class="code">-- change this to be (8000) for SQL Server 2000</span>.</p>
