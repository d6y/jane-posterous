title: More on FxCop Command line integration into Visual Studio
date: 2008/06/13 07:00:00 -0700
tags: [{"name":".NET","id":58671959},{"name":"howto","id":58671957}]
author: Jane Dallaway
alias: /more-on-fxcop-command-line-integration-into-v

<p>We've done some more work on integrating FxCop into our development process this week, and today Mike and I have sat down and started work on choosing which rules to validate against initially.  To do this, we've based our starting set on <a href="http://blogs.msdn.com/fxcop/archive/2007/08/09/what-rules-do-microsoft-have-turned-on-internally.aspx">the rules that Microsoft have switched on internally</a>.  Thus far we've been through the <a href="http://msdn.microsoft.com/en-us/library/ms182125(VS.80).aspx">Design</a>, <a href="http://msdn.microsoft.com/en-us/library/ms182232(VS.80).aspx">Naming</a> (mostly left switched off until the coding standards review is complete) and <a href="http://msdn.microsoft.com/en-us/library/ms182260(VS.80).aspx">Performance</a> rules.  <p />Having set these up in a .FxCop project, I then wanted to be able to make use of the <a href="http://jane.dallaway.com/integrating-fxcop-into-visual-studio-2008">Post Build event</a> to get the assembly analysed according to a predefined set of rules.  This took a bit of research but I think I've got it sorted now:<p />Instead of using:<br /><span class="code">"C:\Program Files\Microsoft FxCop 1.36\FxCopCmd.exe" /c /f:"$(TargetPath)" /r:"C:\Program Files\Microsoft FxCop 1.36\Rules" /consolexsl:"C:\Program Files\Microsoft FxCop 1.36\Xml\VSConsoleOutput.xsl"</span><br />I'm using<br /><span class="code">"C:\Program Files\Microsoft FxCop 1.36\FxCopCmd.exe" /c /f:"$(TargetPath)" /consolexsl:"C:\Program Files\Microsoft FxCop 1.36\Xml\VSConsoleOutput.xsl"  /project:"C:\Program Files\Microsoft FxCop 1.36\DefaultRules.FxCop"</span><br />and so am making use of the "/project" flag to specify the .FxCop file to run, and no longer specifying the /r (or /rule) tag to indicate where to find the rules.  It is important that the .FxCop file doesn't contain any targets of its own, as otherwise both the assembly produced by the build AND the assemblies targetted in the .FxCop file will be analysed, which could lead to a lot of head-scratching when you try to work out why a source file that doesn't exist is causing problems :-)<p />More information on the <a href="http://msdn.microsoft.com/en-us/library/bb429449(VS.80).aspx">options for the FxCop Command Line</a> version is available <a href="http://msdn.microsoft.com/en-us/library/bb429449(VS.80).aspx">here</a>.</p>
