title: Integrating FXCop into Visual Studio 2008
date: 2008/05/28 10:35:00 -0700
tags: [{"name":".NET","id":58672091},{"name":"howto","id":58672096},{"name":"tool","id":58672092}]
author: Jane Dallaway
alias: /integrating-fxcop-into-visual-studio-2008

I was using the <a href="http://fxcopaddin.tigris.org/">FXCopAddin</a> for VS2005 but I couldn't get it to work for VS2008.  The FXCopAddin didn't seem to have been updated for quite some time, and so I didn't have high hopes of it becoming compatible anytime soon.  I really liked the integration that the AddIn gave me, the fact that my warnings were shown in the standard VS error window etc, so I wanted to find a similar, alternative solution.<p />I started with working out the command line version of what I was trying to do - <br /><span class="code">"C:\Program Files\Microsoft FxCop 1.36\FxCopCmd.exe" /c /f:"C:\Working\MyTestApp.exe" /r:"C:\Program Files\Microsoft FxCop 1.36\Rules" /consolexsl:"C:\Program Files\Microsoft FxCop 1.36\Xml\VSConsoleOutput.xsl"</span><p /> Which is, basically, call FXCop (version 1.36) using the Rules dlls specified in "C:\Program Files\Microsoft FxCop 1.36\Rules", and use the XSL file in "C:\Program Files\Microsoft FxCop 1.36\Xml\VSConsoleOutput.xsl" to formulate the output.<p />Moving on from this, I put this working command line into the Post-build event command line as:<br /><span class="code">"C:\Program Files\Microsoft FxCop 1.36\FxCopCmd.exe" /c /f:"$(TargetPath)" /r:"C:\Program Files\Microsoft FxCop 1.36\Rules" /consolexsl:"C:\Program Files\Microsoft FxCop 1.36\Xml\VSConsoleOutput.xsl"</span><p /> Where $(TargetPath) gets equated to the generated dll/exe etc in the build process.<p /><div class='p_embed p_image_embed'>
<img alt="Media_httpfarm4static_hvjab" height="187" src="/media/getfile/files.posterous.com/import-wdma/yEpumizmAfkCDCutlkgymGbAmleClvfIeJkkhqoGHEtAAHbpDugfIHjxEjfa/media_httpfarm4static_HvJaB.jpg.scaled500.jpg" width="240" />
</div>
<p />Behind the scenes, this gets recorded in the .csproj file as:<br /><span class="code">&lt;PropertyGroup&gt;<br />&nbsp;&nbsp;&lt;PostBuildEvent&gt;"C:\Program Files\Microsoft FxCop 1.36\FxCopCmd.exe" /c /f:"$(TargetPath)" /r:"C:\Program Files\Microsoft FxCop 1.36\Rules" /consolexsl:"C:\Program Files\Microsoft FxCop 1.36\Xml\VSConsoleOutput.xsl"&lt;/PostBuildEvent&gt;<br />&lt;/PropertyGroup&gt;</span><p /><div class='p_embed p_image_embed'>
<img alt="Media_httpfarm3static_xwsgo" height="59" src="/media/getfile/files.posterous.com/import-wdma/JfEhcwoJftrGBlbHEFyeCFebuBxqBuGqEcHEnssvGJHtIkGGnlGeqqiaFADn/media_httpfarm3static_xwsGo.jpg.scaled500.jpg" width="240" />
</div>
<p />And bingo, the errors get reported into the warnings window.  From here they are clickable etc.<div class="blogger-post-footer"><img class="posterous_download_image" src="https://blogger.googleusercontent.com/tracker/14400377-5812573639725552037?l=jane.dallaway.com%2Fblog%2Fblog.html" height="1" alt="" width="1" /></div>
