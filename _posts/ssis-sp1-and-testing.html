title: SSIS, SP1 and Testing
date: 2006/08/22 11:04:00 -0700
tags: [{"name":"SQLServer","id":58646768}]
author: Jane Dallaway
alias: /ssis-sp1-and-testing

Having installed my package onto the pre-production environment, and ironed out a heap of database permissions problems, I found myself contemplating the following error...<p /><span class="code">Error: 2006-08-22 13:56:32.93<br />&nbsp;&nbsp;Code: 0xC002F210<br />&nbsp;&nbsp;Source: Get Data<br />&nbsp;&nbsp;Description: Executing the query "EXEC PRC_DATA_SEL ?" failed with the following error: "End tag 'Description' does not match the start tag 'ROOT'.". Possible failure reasons: Problems with the query, "ResultSet" property not set correctly, parameters not set correctly, or connection not established correctly.<br />End Error</span><p />When I connect to the pre-production database via my dev package having changed the configuration file, it functions as expected without a problem.  So it isn't a database problem.  When I change the pre-production configuration to point at my dev database, I get problems - so it looks like a machine related problem.<p />I then put Integration Services on to another test machine, and tried from there, and had success.  So there was obviously something different about our pre-production box to both my dev environment and my newly borrowed test kit.  The OS's were different, so I then spent a frantic 5 minutes checking that Integration Services should run on Windows 2000 Server SP4 - <a href="http://msdn2.microsoft.com/en-us/library/ms143506.aspx">which it should</a>.<p />Finally, I decided to install <a href="http://support.microsoft.com/?kbid=913090">SP1</a> on my test (previously working) machine, and that too stopped working - not with exactly the same error but at this stage that was good enough.  So, I've rolled back the pre-production environment to be pre-SP1 and now the package runs.<p />Not a great solution, but it'll do for the moment.  Next step - upgrade my dev environment to be SP1 and re-work as necessary.  And the moral of this story is always ensure your dev environment matches your pre-production and live.  I'm glad I found out before the live stage though :-)<div class="blogger-post-footer"><img class="posterous_download_image" src="https://blogger.googleusercontent.com/tracker/14400377-115626642025033542?l=jane.dallaway.com%2Fblog%2Fblog.html" height="1" alt="" width="1" /></div>
