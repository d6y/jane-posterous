title: More on spu_generateinsert
date: 2008/01/15 11:32:00 -0800
tags: [{"name":"download","id":3772789},{"name":"SQLServer","id":3772790}]
author: Jane Dallaway
alias: /more-on-spugenerateinsert

<p>Dave posted a comment on the <a href="http://jane.dallaway.com/generate-sql-insert-statement-from-table-data">original post</a> the other day seeking for help with resolving an error he was having running <a href="https://github.com/janedallaway/SQL-Server-Helper-Scripts/blob/master/spu_generateInsert.sql">the script</a>.  The problem transpired to be with dealing with columns of data type image.  On investigation, I discovered that there were quite a few column types which wouldn't work as they hadn't been catered for.<p />I've updated the script to work with all the data types I can get it to work with.  For images, binary and varbinary columns, it attempts to insert NULL and puts a warning at the bottom of the generated script saying:<br /><span class="code">-- ** WARNING: There is an image column in your table which has not been migrated - this has been replaced with NULL.  You will need to do this by hand.  Images are not supported by this script at this time.</span> or <br /><span class="code">-- ** WARNING: There is a binary or varbinary column in your table which has not been migrated - this has been replaced with NULL.  You will need to do this by hand.  Binary and VarBinary are not supported by this script at this time.</span> as appropriate<br />This isn't great, but is at least informative and explains what has happened.<p />I will try and think about a way of scripting out data from columns of type image, binary and varbinary, but at least, in the meantime the script no longer errors (at least to my knowledge - if you know otherwise, then please let me know and I'll make more fixes).<p />Download updated <a href="https://github.com/janedallaway/SQL-Server-Helper-Scripts/blob/master/spu_generateInsert.sql">spu_generateinsert</a>.</p>
