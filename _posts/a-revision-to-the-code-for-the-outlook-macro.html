title: A revision to the code for the outlook macro to forward an email to Toodledoo
date: 2009/11/27 05:06:00 -0800
tags: [{"name":"code","id":3772462},{"name":"productivity","id":58676373}]
author: Jane Dallaway
alias: /a-revision-to-the-code-for-the-outlook-macro

<p>Just a minor update to the <a href="http://jane.dallaway.com/outlook-macro-to-forward-an-email-to-toodledo">existing macro</a>, to determine if the current day is Friday, and to action the item for Monday rather than tomorrow<p />Code in full:<br /><span class="code">Sub Toodledo()<br />'Forward the selected email to Toodledo, updating the subject with the appropriate shortcuts and move to appropriate folder<br />On Error Resume Next<p />&nbsp;&nbsp;Dim objMail As Outlook.MailItem<br />&nbsp;&nbsp;Dim objItem As Outlook.MailItem<p />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set objItem = GetCurrentItem()<br />&nbsp;&nbsp;Set objMail = objItem.Forward<p />&nbsp;&nbsp;&nbsp;&nbsp;Dim strWhenToAction<br />&nbsp;&nbsp;objMail.To = "" 'my toodledo email address<br />&nbsp;&nbsp;If (DatePart("w", Now) = vbFriday) Then<br />&nbsp;&nbsp;&nbsp;&nbsp;strWhenToAction = "monday"<br />&nbsp;&nbsp;Else<br />&nbsp;&nbsp;&nbsp;&nbsp;strWhenToAction = "tomorrow"<br />&nbsp;&nbsp;End If<p />&nbsp;&nbsp;&nbsp;&nbsp;objMail.Subject = "Respond to " + objMail.Subject + " @@work #" + strWhenToAction + " *Actioned" 'Prefix with Respond to, and append context of @work, date of tomorrow, and folder of Actioned<br />&nbsp;&nbsp;objMail.Send<p />&nbsp;&nbsp;&nbsp;&nbsp;Call MoveMessageToFolder(objItem, "Actions")  'move it to my Actions folder<p />&nbsp;&nbsp;&nbsp;&nbsp;'clean up<br />&nbsp;&nbsp;Set objMail = Nothing<br />&nbsp;&nbsp;Set objItem = Nothing<p />End Sub<p />Private Function GetCurrentItem() As Outlook.MailItem<br />'Taken from code sample provided at <a href="http://www.pcreview.co.uk/forums/thread-2798274.php">http://www.pcreview.co.uk/forums/thread-2798274.php</a><br />On Error Resume Next<p />&nbsp;&nbsp;&nbsp;&nbsp;Dim objApp As Outlook.Application<br />&nbsp;&nbsp;Set objApp = Application<p />&nbsp;&nbsp;&nbsp;&nbsp;On Error Resume Next<p />&nbsp;&nbsp;&nbsp;&nbsp;Select Case TypeName(objApp.ActiveWindow)<br />&nbsp;&nbsp;&nbsp;&nbsp;Case "Explorer"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set GetCurrentItem = objApp.ActiveExplorer.Selection.Item(1)<br />&nbsp;&nbsp;&nbsp;&nbsp;Case "Inspector"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set GetCurrentItem = objApp.ActiveInspector.CurrentItem<br />&nbsp;&nbsp;&nbsp;&nbsp;Case Else<br />&nbsp;&nbsp;End Select<p />&nbsp;&nbsp;&nbsp;&nbsp;'clean up<br />&nbsp;&nbsp;Set objApp = Nothing<br />End Function<p />Private Sub MoveMessageToFolder(objItem As Outlook.MailItem, ByVal sFolder As String)<br />'Loosely based on code found at <a href="http://verychewy.com/archive/2006/04/12/outlook-macro-to-move-an-email-to-folder.aspx">http://verychewy.com/archive/2006/04/12/outlook-macro-to-move-an-email-to-fol...</a><br />On Error Resume Next<p /> &nbsp;&nbsp;Dim objFolder As Outlook.MAPIFolder<br />&nbsp;&nbsp;Dim objInbox As Outlook.MAPIFolder<br />&nbsp;&nbsp;Dim objNS As Outlook.NameSpace<p /> &nbsp;&nbsp;Set objNS = Application.GetNamespace("MAPI")<br />&nbsp;&nbsp;Set objInbox = objNS.GetDefaultFolder(olFolderInbox)<br />&nbsp;&nbsp;Set objFolder = objInbox.Folders(sFolder)<p /> &nbsp;&nbsp;If objFolder Is Nothing Then<br />&nbsp;&nbsp;&nbsp;&nbsp;MsgBox "This folder doesn't exist!", vbOKOnly + vbExclamation, "INVALID FOLDER"<br />&nbsp;&nbsp;End If<p />&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;objItem.Move objFolder<p />&nbsp;&nbsp;  &nbsp;&nbsp;'Clean up<br />&nbsp;&nbsp;Set objFolder = Nothing<br />&nbsp;&nbsp;Set objInbox = Nothing<br />&nbsp;&nbsp;Set objNS = Nothing<br />End Sub<br /></span><p />The <a href="http://jane.dallaway.com/outlook-macro-to-forward-an-email-to-toodledo">previous post</a> contains hints on signing macros etc</p>
