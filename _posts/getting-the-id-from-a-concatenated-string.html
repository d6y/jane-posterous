title: Getting the ID from a concatenated string
date: 2007/12/04 10:33:00 -0800
tags: [{"name":"code","id":58678570},{"name":"SQLServer","id":3772813}]
author: Jane Dallaway
alias: /getting-the-id-from-a-concatenated-string

A colleague is doing some data migration work, and had a string he needed to manipulate to get at the id.  The string had been put together as a title, with spaces replaced with -, and an ID with the title and ID separated by a -, i.e. Software-Developer-123 where title is Software Developer and the ID is 123.<p />He'd written some code to manipulate this, but it was taking quite a while and wanted to know if there was a one line TSQL statement to do it.<p />After a bit of head scratching we came up with the following:<p /><span class="code">DECLARE @strTemp VARCHAR(100)<br />SET @strTemp = 'Software-Developer-123'<br />SELECT SUBSTRING(@strTemp, LEN(@strTemp)-(CHARINDEX('-',REVERSE(@strTemp)))+2, CHARINDEX('-',REVERSE(@strTemp))-1)</span><p />This returns 123, and so is a (long) one line fix to his problem.  As there is no LastIndexOf or similar function, I've used the <a href="http://msdn2.microsoft.com/en-us/library/ms180040.aspx">REVERSE</a> function to enable us to find the last instance of - and then its just some manipulation using <a href="http://msdn2.microsoft.com/en-us/library/ms186323.aspx">CHARINDEX</a> and <a href="http://msdn2.microsoft.com/en-us/library/ms187748.aspx">SUBSTRING</a> to get at the ID.  The use of the variable @strTemp was just so we could easily swap in different test data and so isn't of any real importance to the solution.<p />I really enjoy challenges like this and have emailed this on as a brainteaser to the rest of the development team.<p />Update:<br /><span class="code">@DECLARE @strTemp VARCHAR(100)<br />SET @strTemp = 'Software-Developer-123'<p />SELECT RIGHT(@strTemp, CHARINDEX('-',REVERSE(@strTemp))-1)</span><br />A lot cleaner :-)  Thanks Alex.<div class="blogger-post-footer"><img class="posterous_download_image" src="https://blogger.googleusercontent.com/tracker/14400377-43554145633871706?l=jane.dallaway.com%2Fblog%2Fblog.html" height="1" alt="" width="1" /></div>
