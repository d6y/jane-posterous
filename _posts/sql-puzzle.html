title: SQL Puzzle
date: 2007/07/11 04:40:00 -0700
tags: [{"name":"code","id":58678604},{"name":"SQLServer","id":58678599}]
author: Jane Dallaway
alias: /sql-puzzle

Mike just came to me with an interesting problem.  One of the tables that he needs to query has some comma separated values.  He needs to search for a specific value in that column.  There was no time or opportunity to refactor the table into a joining table, so it needed to be based around the <span class="code">Like</span> function.  <p />His sample data contained a column Keyword with data like the following:<br /><span class="code">Sport<br />Transport<br />Sport, Transport<br />Transport, Media, Sport</span><p />He was looking for the keyword "Sport" and was matching all of the above 4 rows, rather than just rows 1, 3 and 4.<p />It took me a bit of head scratching, but I finally proposed the following solution:<br /><span class="code">SELECT *<br />FROM Table<br />WHERE ' ' + REPLACE(Keyword,',',' ') + ' ' LIKE '% Sport %'</span><br />So, prefixing and suffixing the data with a space, and <a href="http://msdn2.microsoft.com/en-us/library/ms186862.aspx">replacing</a> the comma being used for separation with a space, and then comparing it against our target word which is also prefixed and suffixed by a space. <p />This solution feels like a bit of a cludge, but less arduous than implementing a Split function.  Opinions always welcomed<div class="blogger-post-footer"><img class="posterous_download_image" src="https://blogger.googleusercontent.com/tracker/14400377-2565467796598611584?l=jane.dallaway.com%2Fblog%2Fblog.html" height="1" alt="" width="1" /></div>
